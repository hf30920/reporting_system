# 项目代码结构分析
## 项目概述
这是一个基于Flask框架开发的舆情分析报告系统，主要功能包括数据爬取、数据存储、数据分析和可视化展示。系统采用模块化设计，包含爬虫模块、数据处理模块、视图模块和前端展示模块。

## 代码结构与入口
### 主入口
- app.py `app.py` : Flask应用主入口，负责初始化应用、注册蓝图、定义全局路由和请求钩子。
  - 应用初始化：创建Flask实例，设置密钥
  - 蓝图注册：注册page和user两个蓝图
  - 全局路由：根路由重定向到登录页面
  - 请求钩子：实现权限验证，未登录用户重定向到登录页面
  - 错误处理：404页面处理
### 视图层（Views） 页面蓝图（page）
- page.py `page.py` : 负责所有功能页面的路由和渲染
  - 主页（/page/home）：展示数据概览、热门评论、统计数据图表
  - 表格数据页（/page/tableData）：展示基于热词的评论数据
  - 文章表格页（/page/tableDataArticle）：展示文章数据列表
  - 文章图表页（/page/articleChar）：展示文章相关统计图表
  - IP图表页（/page/ipChar）：展示地理位置分布图表
  - 评论图表页（/page/commentChar）：展示评论相关统计图表
  - 舆情图表页（/page/yuqingChar）：展示舆情分析图表
  - 内容云图页（/page/contentCloud）：展示内容词云 用户蓝图（user）
- user.py `user.py` : 负责用户认证功能
  - 登录（/user/login）：用户登录验证
  - 注册（/user/register）：新用户注册
  - 登出（/user/logOut）：用户登出
### 数据处理层（Utils）
- query.py `query.py` : 数据库操作工具函数
  
  - 建立数据库连接
  - 提供通用的SQL查询接口
- getPublicData.py `getPublicData.py` : 公共数据获取函数
  
  - 获取所有文章数据
  - 获取所有评论数据
  - 获取词频统计结果
- getHomeData.py `getHomeData.py` : 首页数据处理函数
  
  - 获取热门评论
  - 统计标签数据（文章总数、最多点赞作者、最多文章城市）
  - 生成各类图表数据
- getTableData.py `getTableData.py` : 表格页面数据处理函数
  
  - 获取热词数据
  - 根据热词筛选评论
  - 生成表格数据图表
  - 提供文章数据及情感分析
- getEchartsData.py : （未完整查看）图表数据生成函数
### 爬虫模块（Spider）
- main.py `main.py` : 爬虫主入口
  
  - 协调爬取文章内容
  - 协调爬取评论内容
  - 数据存储到数据库
- spiderContent.py 、 spiderComments.py 、 spiderNav.py : 具体爬虫实现（未完整查看）
### 模型层（Model）
- 包含数据处理和分析相关代码，如词频统计、情感分析等
- yuqing.py : 舆情分析相关功能
- trainModel.py : 模型训练相关功能
### 静态资源和模板
- static/ : 存放CSS、JavaScript、图片等静态资源
- templates/ : 存放HTML模板文件
## 核心功能模块
### 1. 数据采集模块
- 使用爬虫获取文章内容和评论数据
- 支持增量爬取和数据去重
- 将数据存储到MySQL数据库
### 2. 数据处理与分析模块
- 词频统计和分析
- 情感分析（使用SnowNLP）
- 数据聚合和统计
- 生成各类图表数据
### 3. Web展示模块
- 用户认证和权限管理
- 数据可视化展示
- 交互式数据查询
- 词云生成和展示
## 技术栈
- 后端 : Python, Flask, pymysql, pandas
- 数据分析 : jieba, SnowNLP, wordcloud, matplotlib
- 前端 : HTML, CSS, JavaScript, ECharts
- 数据库 : MySQL
## 工作流程
1. 1.
   爬虫模块采集数据并存储到数据库
2. 2.
   用户通过登录页面进入系统
3. 3.
   根据权限访问不同功能页面
4. 4.
   后端从数据库获取数据，进行处理和分析
5. 5.
   通过ECharts等可视化库在前端展示数据
## 安全机制
- 基于Flask session的用户认证
- 请求前钩子实现权限控制
- 密码验证和用户注册管理
这个项目是一个完整的舆情分析系统，具有数据采集、存储、分析和可视化展示的全流程功能，可以用于对网络舆情进行监控和分析。



app.py - 主应用文件
views/page/page.py - 页面视图
utils/query.py - 数据库查询工具
utils/errorResponse.py - 错误响应处理
utils/getHomeData.py - 首页数据获取
utils/getPublicData.py - 公共数据获取
utils/getTableData.py - 表格数据获取
utils/getEchartsData.py - 图表数据获取
model/trainModel.py - 模型训练
model/yuqing.py - 舆情分析
model/index.py - 分词处理
model/ciPingTotal.py - 词频统计
word_cloud_picture.py - 词云图片生成
spider/spiderNav.py - 导航爬虫
spider/spiderContent.py - 内容爬虫
spider/spiderComments.py - 评论爬虫